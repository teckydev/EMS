<mat-dialog-content>
  <ng-container *ngIf="detailData; else loadingTpl">
    <!-- ðŸ”¹ Employee Summary -->
    <h2 class="text-2xl font-semibold text-indigo-700 mb-4">
      Employee Attendance Summary
    </h2>

    <div class="grid grid-cols-2 gap-4 text-gray-700 border-b border-gray-200 pb-3 mb-4">
      <p><strong>Employee ID:</strong> {{ detailData.employee?.empId }}</p>
      <p><strong>Name:</strong> {{ detailData.employee?.name }}</p>

      <!-- âœ… Dynamic Position (from first record) -->
      <p>
        <strong>Position:</strong>
        {{ detailData.records[0]?.employee?.position || 'N/A' }}
      </p>

      <p><strong>Total Days:</strong> {{ detailData.totalDays }}</p>
    </div>

    <!-- ðŸ”¹ Attendance Records -->
    <div>
      <h3 class="text-lg font-semibold mb-2 text-gray-800">Attendance Records</h3>

      <table mat-table [dataSource]="detailData.records" class="w-full border border-gray-200 rounded">
        <!-- Date -->
        <ng-container matColumnDef="date">
          <th mat-header-cell *matHeaderCellDef>Date</th>
          <td mat-cell *matCellDef="let record">{{ record.date | date:'mediumDate' }}</td>
        </ng-container>

        <!-- Status -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef>Status</th>
          <td mat-cell *matCellDef="let record">
            <span
              [ngClass]="{
                'text-green-600 font-semibold': record.status === 'Present',
                'text-red-600 font-semibold': record.status === 'Absent',
                'text-yellow-600 font-semibold': record.status === 'Late'
              }"
            >
              {{ record.status }}
            </span>
          </td>
        </ng-container>

        <!-- Total Hours -->
        <ng-container matColumnDef="hours">
          <th mat-header-cell *matHeaderCellDef>Total Hours</th>
          <td mat-cell *matCellDef="let record">
            {{ record.totalHours | number:'1.2-2' }}
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="['date', 'status', 'hours']"></tr>
        <tr mat-row *matRowDef="let row; columns: ['date', 'status', 'hours']"></tr>
      </table>

      <!-- ðŸ”¹ Session Details -->
      <div class="mt-6" *ngFor="let record of detailData.records">
        <h4 class="font-medium text-gray-700 mb-2">
          {{ record.date | date:'mediumDate' }} Sessions
        </h4>

        <table mat-table [dataSource]="record.sessions || []" class="w-full border border-gray-200 rounded">
          <!-- Check In -->
          <ng-container matColumnDef="checkIn">
            <th mat-header-cell *matHeaderCellDef>Check In</th>
            <td mat-cell *matCellDef="let s">{{ s.checkIn | date:'shortTime' }}</td>
          </ng-container>

          <!-- Check Out -->
          <ng-container matColumnDef="checkOut">
            <th mat-header-cell *matHeaderCellDef>Check Out</th>
            <td mat-cell *matCellDef="let s">
              {{ s.checkOut ? (s.checkOut | date:'shortTime') : '-' }}
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="['checkIn', 'checkOut']"></tr>
          <tr mat-row *matRowDef="let row; columns: ['checkIn', 'checkOut']"></tr>
        </table>
      </div>
    </div>
  </ng-container>

  <!-- ðŸ”¹ Loading Template -->
  <ng-template #loadingTpl>
    <div class="flex justify-center items-center h-48">
      <mat-spinner diameter="40"></mat-spinner>
    </div>
  </ng-template>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-raised-button color="primary" (click)="close()">Close</button>
</mat-dialog-actions>
